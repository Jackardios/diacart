!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("diacart",[],e):"object"==typeof exports?exports.diacart=e():t.diacart=e()}(window,function(){return function(r){var n={};function i(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return r[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}return i.m=r,i.c=n,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=54)}([function(t,e){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,e){var r=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=r)},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,r){var n=r(23),i=r(28);t.exports=r(4)?function(t,e,r){return n.f(t,e,i(1,r))}:function(t,e,r){return t[e]=r,t}},function(t,e,r){t.exports=!r(5)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){var r=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+n).toString(36))}},function(t,e,r){var n=r(12);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e,r){var v=r(0),m=r(1),y=r(3),_=r(29),g=r(10),b="prototype",x=function(t,e,r){var n,i,o,a,c=t&x.F,u=t&x.G,s=t&x.S,l=t&x.P,f=t&x.B,d=u?v:s?v[e]||(v[e]={}):(v[e]||{})[b],p=u?m:m[e]||(m[e]={}),h=p[b]||(p[b]={});for(n in u&&(r=e),r)o=((i=!c&&d&&void 0!==d[n])?d:r)[n],a=f&&i?g(o,v):l&&"function"==typeof o?g(Function.call,o):o,d&&_(d,n,o,t&x.U),p[n]!=o&&y(p,n,a),l&&h[n]!=o&&(h[n]=o)};v.core=m,x.F=1,x.G=2,x.S=4,x.P=8,x.B=16,x.W=32,x.U=64,x.R=128,t.exports=x},function(t,e){var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},function(t,e,r){var o=r(30);t.exports=function(n,i,t){if(o(n),void 0===i)return n;switch(t){case 1:return function(t){return n.call(i,t)};case 2:return function(t,e){return n.call(i,t,e)};case 3:return function(t,e,r){return n.call(i,t,e,r)}}return function(){return n.apply(i,arguments)}}},function(t,e,r){var n=r(7),i=r(13);t.exports=function(t){return n(i(t))}},function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,r){var n=r(15),i=Math.min;t.exports=function(t){return 0<t?i(n(t),9007199254740991):0}},function(t,e){var r=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(0<t?n:r)(t)}},function(t,e,r){var n=r(1),i=r(0),o="__core-js_shared__",a=i[o]||(i[o]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:r(37)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e,r){var n=r(13);t.exports=function(t){return Object(n(t))}},function(t,e,r){var n=r(16)("wks"),i=r(6),o=r(0).Symbol,a="function"==typeof o;(t.exports=function(t){return n[t]||(n[t]=a&&o[t]||(a?o:i)("Symbol."+t))}).store=n},function(t,e,r){"use strict";t.exports=r(51)},function(t,e,r){},function(t,e,r){r(22),t.exports=r(1).Object.assign},function(t,e,r){var n=r(8);n(n.S+n.F,"Object",{assign:r(31)})},function(t,e,r){var n=r(24),i=r(25),o=r(27),a=Object.defineProperty;e.f=r(4)?Object.defineProperty:function(t,e,r){if(n(t),e=o(e,!0),n(r),i)try{return a(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},function(t,e,r){var n=r(2);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e,r){t.exports=!r(4)&&!r(5)(function(){return 7!=Object.defineProperty(r(26)("div"),"a",{get:function(){return 7}}).a})},function(t,e,r){var n=r(2),i=r(0).document,o=n(i)&&n(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,r){var i=r(2);t.exports=function(t,e){if(!i(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!i(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!i(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!i(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,r){var o=r(0),a=r(3),c=r(9),u=r(6)("src"),n="toString",i=Function[n],s=(""+i).split(n);r(1).inspectSource=function(t){return i.call(t)},(t.exports=function(t,e,r,n){var i="function"==typeof r;i&&(c(r,"name")||a(r,"name",e)),t[e]!==r&&(i&&(c(r,u)||a(r,u,t[e]?""+t[e]:s.join(String(e)))),t===o?t[e]=r:n?t[e]?t[e]=r:a(t,e,r):(delete t[e],a(t,e,r)))})(Function.prototype,n,function(){return"function"==typeof this&&this[u]||i.call(this)})},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,r){"use strict";var d=r(32),p=r(39),h=r(40),v=r(17),m=r(7),i=Object.assign;t.exports=!i||r(5)(function(){var t={},e={},r=Symbol(),n="abcdefghijklmnopqrst";return t[r]=7,n.split("").forEach(function(t){e[t]=t}),7!=i({},t)[r]||Object.keys(i({},e)).join("")!=n})?function(t,e){for(var r=v(t),n=arguments.length,i=1,o=p.f,a=h.f;i<n;)for(var c,u=m(arguments[i++]),s=o?d(u).concat(o(u)):d(u),l=s.length,f=0;f<l;)a.call(u,c=s[f++])&&(r[c]=u[c]);return r}:i},function(t,e,r){var n=r(33),i=r(38);t.exports=Object.keys||function(t){return n(t,i)}},function(t,e,r){var a=r(9),c=r(11),u=r(34)(!1),s=r(36)("IE_PROTO");t.exports=function(t,e){var r,n=c(t),i=0,o=[];for(r in n)r!=s&&a(n,r)&&o.push(r);for(;e.length>i;)a(n,r=e[i++])&&(~u(o,r)||o.push(r));return o}},function(t,e,r){var u=r(11),s=r(14),l=r(35);t.exports=function(c){return function(t,e,r){var n,i=u(t),o=s(i.length),a=l(r,o);if(c&&e!=e){for(;a<o;)if((n=i[a++])!=n)return!0}else for(;a<o;a++)if((c||a in i)&&i[a]===e)return c||a||0;return!c&&-1}}},function(t,e,r){var n=r(15),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=n(t))<0?i(t+e,0):o(t,e)}},function(t,e,r){var n=r(16)("keys"),i=r(6);t.exports=function(t){return n[t]||(n[t]=i(t))}},function(t,e){t.exports=!1},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,r){r(42),t.exports=r(1).Array.find},function(t,e,r){"use strict";var n=r(8),i=r(43)(5),o="find",a=!0;o in[]&&Array(1)[o](function(){a=!1}),n(n.P+n.F*a,"Array",{find:function(t){return i(this,t,1<arguments.length?arguments[1]:void 0)}}),r(47)(o)},function(t,e,r){var g=r(10),b=r(7),x=r(17),T=r(14),n=r(44);t.exports=function(f,t){var d=1==f,p=2==f,h=3==f,v=4==f,m=6==f,y=5==f||m,_=t||n;return function(t,e,r){for(var n,i,o=x(t),a=b(o),c=g(e,r,3),u=T(a.length),s=0,l=d?_(t,u):p?_(t,0):void 0;s<u;s++)if((y||s in a)&&(i=c(n=a[s],s,o),f))if(d)l[s]=i;else if(i)switch(f){case 3:return!0;case 5:return n;case 6:return s;case 2:l.push(n)}else if(v)return!1;return m?-1:h||v?v:l}}},function(t,e,r){var n=r(45);t.exports=function(t,e){return new(n(t))(e)}},function(t,e,r){var n=r(2),i=r(46),o=r(18)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),n(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,r){var n=r(12);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,r){var n=r(18)("unscopables"),i=Array.prototype;null==i[n]&&r(3)(i,n,{}),t.exports=function(t){i[n][t]=!0}},function(t,e){var r,n;r=Element.prototype,n=r.matches||r.matchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector,r.matches=r.matchesSelector=n||function(t){var e=document.querySelectorAll(t),r=this;return Array.prototype.some.call(e,function(t){return t===r})}},function(t,e){Element.prototype.closest||(Element.prototype.closest=function(t){return this?this.matches(t)?this:this.parentElement?this.parentElement.closest(t):null:null})},function(t,e,r){var n=r(19);t.exports=function(t){"use strict";t=t||{};var e="",r=n.$escape;return e+='<div class="diacart-wrapper"><section class="diacart"><div class="diacart__header"><div class="diacart__title">',e+=r(t.title||""),e+='</div></div><div class="diacart__items" data-diacart-items-container></div><div class="diacart__footer" data-diacart-hidden-if-empty><div class="diacart__footer-container"><div class="diacart__total-price">',e+=r(t.totalPriceText?t.totalPriceText+": ":""),e+='<span data-diacart-total-price-container></span></div><button class="diacart__order-btn diacart-btn diacart-btn--primary diacart-btn--medium" data-diacart-order>',e+=r(t.orderBtnText||""),e+="</button></div></div></section></div>"}},function(n,t,e){"use strict";(function(t){
/*! art-template@runtime | https://github.com/aui/art-template */
var e="undefined"==typeof window,r=Object.create(e?t:window),c=/["&'<>]/;r.$escape=function(t){return function(t){var e=""+t,r=c.exec(e);if(!r)return t;var n="",i=void 0,o=void 0,a=void 0;for(i=r.index,o=0;i<e.length;i++){switch(e.charCodeAt(i)){case 34:a="&#34;";break;case 38:a="&#38;";break;case 39:a="&#39;";break;case 60:a="&#60;";break;case 62:a="&#62;";break;default:continue}o!==i&&(n+=e.substring(o,i)),o=i+1,n+=a}return o!==i?n+e.substring(o,i):n}(function t(e){"string"!=typeof e&&(e=null==e?"":"function"==typeof e?t(e.call(e)):JSON.stringify(e));return e}(t))},r.$each=function(t,e){if(Array.isArray(t))for(var r=0,n=t.length;r<n;r++)e(t[r],r);else for(var i in t)e(t[i],i)},n.exports=r}).call(this,e(52))},function(Jg,Kg){var Lg;Lg=function(){return this}();try{Lg=Lg||Function("return this")()||eval("this")}catch(t){"object"==typeof window&&(Lg=window)}Jg.exports=Lg},function(t,e,r){var n=r(19);t.exports=function(t){"use strict";t=t||{};var e="",r=n.$escape;return e+='<div class="diacart-item" data-diamodal-item data-diacart-item-id="',e+=r(t.item.id||""),e+='"><div class="diacart-grid"> ',t.item.obj.image&&(e+=' <div class="diacart-grid-col diacart-grid-col--v-gutter diacart-grid-col--auto diacart-item__image-col"><a href="',e+=r(t.item.obj.link||""),e+='" class="diacart-item__image-container"><img src="',e+=r(t.item.obj.image||""),e+='" alt="',e+=r(t.item.obj.name||""),e+='" class="diacart-item__image"></a></div> '),e+=' <div class="diacart-grid-col diacart-grid-col--v-gutter diacart-grid-col--flex diacart-item__text-col"> ',t.itemHasPrice&&t.item.obj.price&&(e+=' <div class="diacart-item__price">',e+=r(t.item.obj.price||""),e+=r(t.currency||""),e+="</div> "),e+=' <a href="',e+=r(t.item.obj.link||""),e+='" class="diacart-item__title">',e+=r(t.item.obj.name||""),e+="</a> ",t.itemHasQuantity&&t.item.obj.quantity&&(e+=' <div class="diacart-item__quantity diacart-counter"><div class="diacart-counter__container diacart-grid diacart-grid--no-gutter"><button class="diacart-grid__col diacart-grid__col--auto diacart-counter__btn diacart-counter__plus-btn">+</button> <input class="diacart-grid__col diacart-grid__col--flex diacart-counter__input" type="number" name="quantity" data-diacart-quantity-input data-diacart-item-id="',e+=r(t.item.id||""),e+='" value="',e+=r(t.item.obj.quantity||1),e+='"> <button class="diacart-grid__col diacart-grid__col--auto diacart-counter__btn diacart-counter__minus-btn">-</button></div></div> '),e+=' <button class="diacart-item__remove-btn" data-diacart-remove-from-cart data-diacart-item-id="',e+=r(t.item.id||""),e+='">',e+=t.removeFromCartBtnText||"",e+="</button></div></div></div>"}},function(t,e,r){"use strict";r.r(e);r(20),r(21),r(41),r(48),r(49);function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=function(){function n(t){var r=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(t,e){return null};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),!t)throw new Error('Missing required parameter "name"');this._storageName=t,this._onStorageUpdate=e,window.addEventListener("storage",function(t){if(t.key===r._storageName){var e=r._storage;r._storage=JSON.parse(t.newValue||"[]"),r._onStorageUpdate(e,r._storage)}},!1)}var t,e,r;return t=n,(e=[{key:"getLastId",value:function(){var t=this.storage[this.storage.length-1];return t?t.id:0}},{key:"findByQuery",value:function(r){return r?this.storage.find(function(t){for(var e in r)if(r[e]!==t.obj[e])return!1;return!0}):null}},{key:"findById",value:function(e){return e?this.storage.find(function(t){return t.id===e}):null}},{key:"filterByQuery",value:function(r){return r?this.storage.filter(function(t){for(var e in r)if(r[e]!==t.obj[e])return!1;return!0}):[]}},{key:"add",value:function(t){if(!t)return null;var e=this.storage,r={id:this.getLastId()+1,obj:t};return e.push(r),this.storage=e,r}},{key:"update",value:function(t,e){if(t&&e)for(var r,n=this.storage,i=0;i<n.length;++i)if(n[i].id===t)return r=Object.assign({},n[i].obj,e),n[i].obj=r,this.storage=n,r;return null}},{key:"removeById",value:function(t){for(var e=this.storage,r=0;r<e.length;++r)if(e[r].id===t){var n=e[r];return e.splice(r,1),this.storage=e,n}return null}},{key:"removeByQuery",value:function(r){if(r){var t=this.storage.filter(function(t){for(var e in r)if(r[e]!==t.obj[e])return!0;return!1});return this.storage=t,!0}return!1}},{key:"clear",value:function(){return this.storage=[],!0}},{key:"count",value:function(){return this.storage.length}},{key:"storage",get:function(){if(!this._storage){var t=this._storage;this._storage=JSON.parse(localStorage.getItem(this._storageName)||"[]"),this._onStorageUpdate(t,this._storage)}return this._storage},set:function(t){var e=this._storage;this._storage=t,localStorage.setItem(this._storageName,JSON.stringify(this._storage)),this._onStorageUpdate(e,this._storage)}}])&&i(t.prototype,e),r&&i(t,r),n}();function a(t,e,r,n){var i=4<arguments.length&&void 0!==arguments[4]&&arguments[4];t.addEventListener(e,function(t){for(var e=t.target;e&&e!=this;e=e.parentNode)if(e.matches(r)){n.call(e,t);break}},i)}function c(t,e){var r;document.createEvent?(r=document.createEvent("HTMLEvents")).initEvent(e,!0,!0):(r=document.createEventObject()).eventType=e,r.eventName=e,document.createEvent?t.dispatchEvent(r):t.fireEvent("on"+r.eventType,r)}var u={wrapper:".diacart-counter",buttonPlus:".diacart-counter__plus-btn",buttonMinus:".diacart-counter__minus-btn",input:".diacart-counter__input"};function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f={name:"diacart",title:"Корзина покупок",totalPriceText:"Итоговая сумма",totalQuantityText:"Количество",removeFromCartBtnText:"",emptyCartText:'<div class="diacart-empty"><h2 class="diacart-empty__title">Ваша корзина пуста</h2></div>',orderBtnText:"Оформить заказ",currency:"р.",groupBy:"id",itemHasQuantity:!0,itemHasPrice:!0,itemCustomFields:[],hiddenClass:"diacart-hidden",wrapperTemplate:r(50),itemTemplate:r(53),totalPriceTemplate:function(t){return parseFloat(t.totalPrice).toFixed(2)+(t.currency||"")},totalQuantityTemplate:function(t){return parseInt(t.totalQuantity)},containerSelector:"[data-diacart-container]",totalPriceContainerSelector:"[data-diacart-total-price-container]",totalQuantityContainerSelector:"[data-diacart-total-quantity-container]",itemsContainerSelector:"[data-diacart-items-container]",itemSelector:"[data-diacart-item]",hiddenIfEmptySelector:"[data-diacart-hidden-if-empty]",addToCartBtnSelector:"[data-diacart-add-to-cart]",removeFromCartBtnSelector:"[data-diacart-remove-from-cart]",quantityInputSelector:"[data-diacart-quantity-input]",orderBtnSelector:"[data-diacart-order]",onInit:function(t){return t},onAdd:function(t){return t},onUpdate:function(t){return t},onRemove:function(t){return t},onClear:function(t){return t},onOrder:function(t){return t},onRefresh:function(t){return t}},n=function(){function e(t){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),l(this,"add",function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(!t&&console&&console.log)console.log("'item' argument is undefined!");else{if(t.quantity=a._options.itemHasQuantity&&t.quantity&&0<t.quantity?t.quantity:1,a._options.groupBy){var e=l({},a._options.groupBy,t[a._options.groupBy]),r=a._groupItemsByQuery(e);if(r){var n=Object.assign({},t,{quantity:r.obj.quantity+t.quantity});a._storage.update(r.id,n)}else a._storage.add(t);return void a._options.onAdd(t)}a._storage.add(t),a._options.onAdd(t)}}),l(this,"update",function(t,e){a._storage.update(t,e),a._options.onUpdate()}),l(this,"remove",function(t){t||new Error("'id' argument is required"),a._storage.removeById(t),a._options.onRemove(t)}),l(this,"clear",function(){a._storage.clear(),a._options.onClear()}),l(this,"order",function(){a._options.onOrder(a._storage.storage)}),l(this,"refresh",function(t,e){a.refreshTotalPrice(),a.refreshTotalQuantity(),a.renderCartItems(),a.updateHiddenIfEmpty(),a._options.onRefresh(t,e)}),l(this,"updateHiddenIfEmpty",function(){if(a._storage.storage.length)for(var t=0;t<a._hiddenIfEmpty.length;++t)i=a._hiddenIfEmpty[t],o=a._options.hiddenClass,i.classList?i.classList.remove(o):i.className=i.className.replace(new RegExp("(^|\\b)"+o.split(" ").join("|")+"(\\b|$)","gi")," ");else for(var e=0;e<a._hiddenIfEmpty.length;++e)r=a._hiddenIfEmpty[e],n=a._options.hiddenClass,r.classList?r.classList.add(n):r.className+=" "+n;var r,n,i,o}),l(this,"refreshTotalPrice",function(){a._totalPrice=a._calculateTotalPrice(),a.renderTotalPrice()}),l(this,"refreshTotalQuantity",function(){a._totalQuantity=a._calculateTotalQuantity(),a.renderTotalQuantity()}),l(this,"_itemsTemplate",function(e){var r="";return e.items&&e.items.length?e.items.forEach(function(t){e.item=t,r+=e.itemTemplate(e)}):r+=e.emptyCartText,r}),this._options=Object.assign({},f,t),this.init()}var t,r,n;return t=e,(r=[{key:"init",value:function(){this._storage=new o(this._options.name,this.refresh),this._containers=document.querySelectorAll(this._options.containerSelector),this.renderCart(),this._itemsContainer=document.querySelector(this._options.itemsContainerSelector),this._totalPriceContainers=document.querySelectorAll(this._options.totalPriceContainerSelector),this._totalQuantityContainers=document.querySelectorAll(this._options.totalQuantityContainerSelector),this._hiddenIfEmpty=document.querySelectorAll(this._options.hiddenIfEmptySelector),this.renderCartItems(),this.refreshTotalQuantity(),this.refreshTotalPrice(),this.updateHiddenIfEmpty(),this._attachEventHandlers(),this._options.onInit(this),function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:u;t&&(a(t,"click",n.buttonPlus,function(){var t=this.closest(n.wrapper).querySelector(n.input),e=parseInt(t.value),r=-1<e?e+1:1;t.value=r,c(t,"change")}),a(t,"click",n.buttonMinus,function(){var t=this.closest(n.wrapper).querySelector(n.input),e=parseInt(t.value),r=1<e?e-1:e;t.value=r,c(t,"change")}))}(this._itemsContainer)}},{key:"_attachEventHandlers",value:function(){var n=this,i=this;if(a(document,"click",this._options.orderBtnSelector,function(t){t.preventDefault(),n.order()},!0),a(document,"click",this._options.addToCartBtnSelector,function(t){t.preventDefault();var e=this.getAttribute("data-diacart-item-json"),r=JSON.parse(e);i.add(r)},!0),a(document,"click",this._options.removeFromCartBtnSelector,function(t){if(t.preventDefault(),this){var e=parseInt(this.getAttribute("data-diacart-item-id"));i.remove(e)}},!0),this._itemsContainer){var e,r=function(t){if(t.target){var e=parseInt(t.target.getAttribute("data-diacart-item-id"));if(t.target.value){var r=parseInt(t.target.value);0<r&&(t.target.blur(),n.update(e,{quantity:r}))}}};a(this._itemsContainer,"change",this._options.quantityInputSelector,r),a(this._itemsContainer,"keyup",this._options.quantityInputSelector,function(t){clearTimeout(e),e=setTimeout(function(){return r(t)},300)})}}},{key:"_groupItemsByQuery",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(t){var e=this._storage.filterByQuery(t);if(e.length){var r=e[0];if(1<e.length){for(var n=0,i=0;i<e.length;i++)e[i].obj&&(n+=e[i].obj.quantity?parseInt(e[i].obj.quantity):1);r.obj.quantity=n,this._storage.removeByQuery(t),this._storage.add(r.obj)}return r}}return null}},{key:"_calculateTotalQuantity",value:function(){var e=this,r=0;return this._storage.storage.forEach(function(t){r+=e._options.itemHasQuantity&&t.obj.quantity?parseInt(t.obj.quantity):1}),r}},{key:"_calculateTotalPrice",value:function(){var r=this,n=0;return this._options.itemHasPrice&&this._storage.storage.forEach(function(t){var e=r._options.itemHasQuantity&&t.obj.quantity?parseInt(t.obj.quantity):1;n+=(t.obj.price?parseFloat(t.obj.price):0)*e}),n}},{key:"hasItem",value:function(t){return!!this._storage.findByQuery(t)}},{key:"_renderTemplateToContainers",value:function(t,e,r){if(t&&t.length)for(var n=e(r),i=0;i<t.length;++i)t[i]&&(t[i].innerHTML=n)}},{key:"renderCart",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._containers,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this._options.wrapperTemplate;this._renderTemplateToContainers(t,e,{title:this._options.title,totalPriceText:this._options.totalPriceText,totalQuantityText:this._options.totalQuantityText,totalPrice:this._totalPrice,totalQuantity:this._totalQuantity,itemHasPrice:this._options.itemHasPrice,itemHasQuantity:this._options.itemHasQuantity,orderBtnText:this._options.orderBtnText})}},{key:"renderCartItems",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._itemsContainer,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this._options.itemTemplate;this._renderTemplateToContainers([t],this._itemsTemplate,{itemTemplate:e,items:this._storage.storage,currency:this._options.currency,itemHasPrice:this._options.itemHasPrice,itemHasQuantity:this._options.itemHasQuantity,itemCustomFields:this._options.itemCustomFields,emptyCartText:this._options.emptyCartText,removeFromCartBtnText:this._options.removeFromCartBtnText})}},{key:"renderTotalPrice",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._totalPriceContainers,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this._options.totalPriceTemplate;this._renderTemplateToContainers(t,e,{totalPrice:this._totalPrice,currency:this._options.currency})}},{key:"renderTotalQuantity",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._totalQuantityContainers,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this._options.totalQuantityTemplate;this._renderTemplateToContainers(t,e,{totalQuantity:this._totalQuantity})}}])&&s(t.prototype,r),n&&s(t,n),e}();e.default=n}])});